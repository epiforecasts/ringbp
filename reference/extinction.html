<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Outbreak extinction functions — extinction • ringbp</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Outbreak extinction functions — extinction"><meta name="description" content="extinct_prob(): Calculate proportion of runs that have controlled outbreak
detect_extinct(): Calculate whether outbreaks went extinct or not"><meta property="og:description" content="extinct_prob(): Calculate proportion of runs that have controlled outbreak
detect_extinct(): Calculate whether outbreaks went extinct or not"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ringbp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2.9999</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/ringbp.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/parameter-sweep.html">Scenario parameter sweep</a></li>
    <li><a class="dropdown-item" href="../articles/ringbp-model.html">{ringbp} Model Description</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiforecasts/ringbp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Outbreak extinction functions</h1>
      <small class="dont-index">Source: <a href="https://github.com/epiforecasts/ringbp/blob/main/R/aux_functions.R" class="external-link"><code>R/aux_functions.R</code></a></small>
      <div class="d-none name"><code>extinction.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>extinct_prob()</code>: Calculate proportion of runs that have controlled outbreak</p>
<p><code>detect_extinct()</code>: Calculate whether outbreaks went extinct or not</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">extinct_prob</span><span class="op">(</span><span class="va">scenario</span>, extinction_week <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">detect_extinct</span><span class="op">(</span><span class="va">scenario</span>, extinction_week <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-scenario">scenario<a class="anchor" aria-label="anchor" href="#arg-scenario"></a></dt>
<dd><p>a <code>data.table</code>: weekly cases output by <code><a href="scenario_sim.html">scenario_sim()</a></code></p></dd>


<dt id="arg-extinction-week">extinction_week<a class="anchor" aria-label="anchor" href="#arg-extinction-week"></a></dt>
<dd><p>By default <code>NULL</code> but also accepts a positive
<code>integer</code> scalar or <code>integer</code> vector to test if the outbreak has gone
extinct (i.e. no new cases) by this week (zero indexed):</p><ul><li><p>By default (<code>NULL</code>) the extinction status is stored in the output of
<code><a href="scenario_sim.html">scenario_sim()</a></code> which is supplied to the <code>scenario</code> argument. If
<code>extinction_week</code> is not specified or specified as <code>NULL</code> then the
pre-computed extinction status from the outbreak simulation will be used.
This is defined as all infectious cases have had the opportunity to
transmit but no new cases are generated.</p></li>
<li><p>A single <code>integer</code> to test if extinction has occurred by this week.
For example, <code>extinction_week = 5</code> tests whether the outbreak is
extinct by week 5 (inclusive) until the end of the outbreak.</p></li>
<li><p>An <code>integer</code> vector of length two can be supplied to provide the lower
and upper bounds (inclusive) of the week range to test for whether
extinction occurred by this window. For example
<code>extinction_week = c(5, 10)</code> will test whether the outbreak went extinct
by week 5 and there we no new cases between weeks 5 and 10 (inclusive).</p></li>
<li><p>An <code>integer</code> vector of length <em>n</em> can be supplied to provide the weeks
to test for whether extinction occurred by this window. For example
<code>extinction_week = 12:16</code> will test that there are no new infections
between 12 and 16 weeks after the initial cases (inclusive). These
integer sequences will most likely be contiguous but the function
does allow non-contiguous integer sequences.</p></li>
</ul><p>If extinction occurs before the <code>extinction_week</code> window then the outbreak
extinction is considered extinct, however, if the extinction occurs within
the <code>extinction_week</code> window it is not considered extinct. Therefore,
using a single <code>integer</code> for <code>extinction_week</code> and thinking of this as
"<em>has the outbreak gone extinct by week X</em>".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>extinct_prob()</code>: a single <code>numeric</code> with the probability of extinction</p>
<p><code>detect_extinct()</code>: a <code>data.table</code>, with two columns <code>sim</code> and <code>extinct</code>, for a binary
classification of whether the outbreak went extinct in each simulation
replicate. <code>1</code> is an outbreak that went extinct, <code>0</code> if not.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The data passed to <code>scenario</code> has to be produced by <code><a href="scenario_sim.html">scenario_sim()</a></code>.
It cannot be produced by <code><a href="outbreak_model.html">outbreak_model()</a></code> as it requires the <code>sim</code> column,
which is only appended in <code><a href="scenario_sim.html">scenario_sim()</a></code>.</p>
<p><em><strong>Warning</strong></em>: the output from <code><a href="scenario_sim.html">scenario_sim()</a></code> contains an <code>cap_cases</code>
attribute which is used by <code>extinct_prob()</code> and <code>detect_extinct()</code>,
therefore if you modify the output of <code><a href="scenario_sim.html">scenario_sim()</a></code> before passing
to <code>extinct_prob()</code> be careful not to drop the attribute (e.g.
from subsetting the <code>data.table</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="scenario_sim.html">scenario_sim</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  initial_cases <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  offspring <span class="op">=</span> <span class="fu"><a href="offspring_opts.html">offspring_opts</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    community <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, mu <span class="op">=</span> <span class="fl">2.5</span>, size <span class="op">=</span> <span class="fl">0.16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    isolated <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, mu <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  delays <span class="op">=</span> <span class="fu"><a href="delay_opts.html">delay_opts</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    incubation_period <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">rweibull</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, shape <span class="op">=</span> <span class="fl">2.32</span>, scale <span class="op">=</span> <span class="fl">6.49</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    onset_to_isolation <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">rweibull</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, shape <span class="op">=</span> <span class="fl">1.65</span>, scale <span class="op">=</span> <span class="fl">4.28</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  event_probs <span class="op">=</span> <span class="fu"><a href="event_prob_opts.html">event_prob_opts</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    asymptomatic <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    presymptomatic_transmission <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>    symptomatic_ascertained <span class="op">=</span> <span class="fl">0.2</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  interventions <span class="op">=</span> <span class="fu"><a href="intervention_opts.html">intervention_opts</a></span><span class="op">(</span>quarantine <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sim <span class="op">=</span> <span class="fu"><a href="sim_opts.html">sim_opts</a></span><span class="op">(</span>cap_max_days <span class="op">=</span> <span class="fl">350</span>, cap_cases <span class="op">=</span> <span class="fl">4500</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate probability of extinction</span></span></span>
<span class="r-in"><span><span class="fu">extinct_prob</span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating extinction using the extinction status from the simulation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># determine if each outbreak simulation replicate has gone extinct</span></span></span>
<span class="r-in"><span><span class="fu">detect_extinct</span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating extinction using the extinction status from the simulation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       sim extinct</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;int&gt;   &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:     1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:     3       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:     4       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:     5       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:     6       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:     7       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:     8       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:     9       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:    10       1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate extinction in the last 2 weeks of the simulated outbreak</span></span></span>
<span class="r-in"><span><span class="co"># (i.e. the penultimate and last week of the outbreak)</span></span></span>
<span class="r-in"><span><span class="fu">extinct_prob</span><span class="op">(</span><span class="va">res</span>, extinction_week <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">week</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating extinction as no new cases within weeks: 49 to 50 (inclusive).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate extinction as no new cases between weeks 12 and 16 of the outbreak</span></span></span>
<span class="r-in"><span><span class="fu">extinct_prob</span><span class="op">(</span><span class="va">res</span>, extinction_week <span class="op">=</span> <span class="fl">12</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating extinction as no new cases within weeks: 12 to 16 (inclusive).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joel Hellewell, Sam Abbott, Amy Gimma, Tim Lucas, Sebastian Funk, Adam Kucharski, Joshua W. Lambert.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

